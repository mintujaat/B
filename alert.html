<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Alerts - Blogify</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
body {font-family:'Inter',sans-serif; background:#0f1724; color:#e6eef3; margin:0; padding:0;}
.container {max-width:1000px; margin:40px auto; padding:0 20px;}
h1 {color:#06b6d4; margin-bottom:20px; text-align:center;}
form {display:flex; flex-direction:column; gap:12px; background:#1a1b2f; padding:20px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.4);}
input, textarea {padding:12px; border-radius:8px; border:1px solid #2c2d3c; background:#121224; color:#e6eef3; outline:none;}
input:focus, textarea:focus {border-color:#06b6d4; box-shadow:0 0 8px rgba(6,182,212,0.5);}
button {padding:10px; border:none; border-radius:6px; background:#06b6d4; color:#0f1724; font-weight:600; cursor:pointer; transition:0.3s;}
button:hover {background:#38bdf8; color:#0f1724;}
table {width:100%; margin-top:20px; border-collapse:collapse; background:#1a1b2f; border-radius:8px; overflow:hidden;}
th, td {padding:12px; border-bottom:1px solid #2c2d3c; text-align:left;}
th {color:#38bdf8; background:#121224;}
tbody tr:hover {background: rgba(6,182,212,0.1);}
@media(max-width:768px){
  table, tbody, th, td, tr {display:block;}
  th {display:none;}
  td {padding:10px 0; position:relative; padding-left:50%;}
  td::before {content:attr(data-label); position:absolute; left:10px; font-weight:600; color:#38bdf8;}
}
</style>
</head>
<body>

<div class="container">
  <h1>Admin Alerts Panel</h1>
  
  <form id="alertForm">
    <input type="text" id="alertTitle" placeholder="Alert Title" required>
    <textarea id="alertMessage" rows="3" placeholder="Alert Message" required></textarea>
    <button type="submit">Add Alert</button>
  </form>

  <h2 style="margin-top:30px; color:#38bdf8;">All Alerts</h2>
  <table>
    <thead>
      <tr>
        <th>Title</th>
        <th>Message</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="alertsTable"></tbody>
  </table>
</div>

<!-- Firebase JS -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, doc, deleteDoc, query, orderBy } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyA7pGe0YS6HrscAjwjJefgr9tAKO__UZkU",
  authDomain: "blog-2f57c.firebaseapp.com",
  projectId: "blog-2f57c",
  storageBucket: "blog-2f57c.appspot.com",
  messagingSenderId: "608339540577",
  appId: "1:608339540577:web:cd5323ea45e3a4b4dc4820",
  measurementId: "G-JEPHSB73V3"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* ===== Load Alerts ===== */
const alertForm = document.getElementById("alertForm");
const alertsTable = document.getElementById("alertsTable");

async function loadAlerts() {
  alertsTable.innerHTML = "";
  const q = query(collection(db, "alerts"), orderBy("createdAt","desc"));
  const snap = await getDocs(q);
  snap.forEach(docSnap => {
    const data = docSnap.data();
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td data-label="Title">${data.title}</td>
      <td data-label="Message">${data.message}</td>
      <td data-label="Actions">
        <button class="deleteBtn" data-id="${docSnap.id}">ðŸ—‘ Delete</button>
      </td>
    `;
    alertsTable.appendChild(tr);
  });

  // Delete buttons
  document.querySelectorAll(".deleteBtn").forEach(btn => {
    btn.addEventListener("click", async () => {
      const id = btn.dataset.id;
      if(confirm("Delete this alert?")) {
        await deleteDoc(doc(db,"alerts",id));
        loadAlerts();
      }
    });
  });
}
loadAlerts();

/* ===== Add New Alert ===== */
alertForm.addEventListener("submit", async e => {
  e.preventDefault();
  await addDoc(collection(db,"alerts"),{
    title: document.getElementById("alertTitle").value,
    message: document.getElementById("alertMessage").value,
    createdAt: new Date()
  });
  alertForm.reset();
  loadAlerts();
});
</script>
</body>
</html>
